{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
  <a href="{% url 'cases:case-detail' pk=case.pk %}">&larr; Back to Case Details</a>
  <h2 class="mt-2">Request Signature</h2>
  
  <p>You are requesting a signature for the document: <strong>{{ doc.title }}</strong></p>
  
  <form method="POST">
    {% csrf_token %}
    <div class="form-group">
      <label for="user_id_select">Select Signer(s)</label>
      <select class="form-control" id="user_id_select" name="user_id" required>
        <option value="" selected disabled>--- Select a user to send this to ---</option>
        {% for assignment in potential_signers %}
          <option value="{{ assignment.user.pk }}">
            {{ assignment.user.get_full_name|default:assignment.user.username }}
            ({{ assignment.user.roles.first.name }})
          </option>
        {% endfor %}
      </select>
    </div>
    
    <div class="form-group mt-3">
      <label for="message_text">Optional Message</label>
      <textarea class="form-control" name="message" rows="3" 
                placeholder="e.g., 'Please review and sign this document by Friday.'"></textarea>
    </div>
    
    <button type="submit" class="btn btn-primary mt-3">Send Signature Request</button>
  </form>

{% endblock %}